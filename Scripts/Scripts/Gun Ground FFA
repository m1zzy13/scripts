-- Load Rayfield library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create the main window
local Window = Rayfield:CreateWindow({
    Name = "GG FFA",
    LoadingTitle = "Loading GG FFA Script",
    LoadingSubtitle = "By Mizzy",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "Mizzy"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = true,
    KeySettings = {
        Title = "GG FFA KEY | Key is below",
        Subtitle = "mizzy",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"mizzy"}
    }
})

-- Create the main tab
local MainTab = Window:CreateTab("Main/MostUseful", 4483362458)

-- Notification upon script load
Rayfield:Notify({
    Title = "Notification ðŸŒŽ",
    Content = "Execution Successful",
    Duration = 6.5,
    Image = 4483362458,
})

-- Aim assist variables
local aimAssistLoop
local FOVring

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local function removeAimAssist()
    if aimAssistLoop then
        aimAssistLoop:Disconnect()
        aimAssistLoop = nil
    end
    if FOVring then
        FOVring:Remove()
        FOVring = nil
    end
end

local function createAimAssist(toggleName, flag, withRedCircle)
    MainTab:CreateToggle({
        Name = toggleName,
        CurrentValue = false,
        Flag = flag,
        Callback = function(Value)
            local fov = 150
            local smoothing = 1

            local RunService = game:GetService("RunService")
            local UserInputService = game:GetService("UserInputService")

            if withRedCircle and not FOVring then
                FOVring = Drawing.new("Circle")
                FOVring.Visible = true
                FOVring.Thickness = 1.5
                FOVring.Radius = fov
                FOVring.Transparency = 1
                FOVring.Color = Color3.fromRGB(255, 128, 128)
                FOVring.Position = workspace.CurrentCamera.ViewportSize / 2
            end

            local function getClosest(cframe)
                local ray = Ray.new(cframe.Position, cframe.LookVector).Unit
                local target = nil
                local mag = math.huge

                for _, v in pairs(Players:GetPlayers()) do
                    if v ~= LocalPlayer
                        and not LocalPlayer:IsFriendsWith(v.UserId) -- FRIEND CHECK
                        and v.Character
                        and v.Character:FindFirstChild("Head")
                        and v.Character:FindFirstChild("Humanoid")
                        and v.Character:FindFirstChild("HumanoidRootPart")
                        and v.Character.Humanoid.Health > 0
                    then
                        local magBuf = (v.Character.Head.Position - ray:ClosestPoint(v.Character.Head.Position)).Magnitude
                        if magBuf < mag then
                            mag = magBuf
                            target = v
                        end
                    end
                end

                return target
            end

            if Value then
                aimAssistLoop = RunService.RenderStepped:Connect(function()
                    local pressed = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2)
                    local cam = workspace.CurrentCamera
                    local center = cam.ViewportSize / 2

                    if pressed then
                        local curTar = getClosest(cam.CFrame)
                        if curTar then
                            local screenPos = cam:WorldToScreenPoint(curTar.Character.Head.Position)
                            local vec2 = Vector2.new(screenPos.X, screenPos.Y)
                            if (vec2 - center).Magnitude < fov then
                                cam.CFrame = cam.CFrame:Lerp(
                                    CFrame.new(cam.CFrame.Position, curTar.Character.Head.Position),
                                    smoothing
                                )
                            end
                        end
                    end

                    if UserInputService:IsKeyDown(Enum.KeyCode.Delete) then
                        removeAimAssist()
                    end
                end)
            else
                removeAimAssist()
            end
        end
    })
end

-- Aimbot toggles
createAimAssist("Aimbot With FOV Circle", "Toggle1", true)
createAimAssist("Aimbot Without FOV Circle", "Toggle2", false)

-- WalkSpeed
MainTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {1, 350},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "sliderws",
    Callback = function(Value)
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = Value
    end,
})

-- JumpPower
MainTab:CreateSlider({
    Name = "JumpPower",
    Range = {1, 350},
    Increment = 1,
    Suffix = "Power",
    CurrentValue = 16,
    Flag = "sliderjp",
    Callback = function(Value)
        game.Players.LocalPlayer.Character.Humanoid.JumpPower = Value
    end,
})

-- Spinbot
MainTab:CreateSlider({
    Name = "Spinbot",
    Range = {1, 50},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 5,
    Flag = "spinbot",
    Callback = function(Value)
        local plr = Players.LocalPlayer
        repeat task.wait() until plr.Character
        local humRoot = plr.Character:WaitForChild("HumanoidRootPart")
        plr.Character:WaitForChild("Humanoid").AutoRotate = false

        if humRoot:FindFirstChild("Spinbot") then
            humRoot.Spinbot:Destroy()
        end

        local velocity = Instance.new("AngularVelocity")
        velocity.Attachment0 = humRoot:WaitForChild("RootAttachment")
        velocity.MaxTorque = math.huge
        velocity.AngularVelocity = Vector3.new(0, Value, 0)
        velocity.Parent = humRoot
        velocity.Name = "Spinbot"
    end,
})

-- ESP
MainTab:CreateButton({
    Name = "ESP",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/m1zzy13/ESPv6/refs/heads/main/Version6"))()
    end,
})

-- TriggerBot
MainTab:CreateButton({
    Name = "TriggerBot",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/UselessManS90/TriggerBot/main/TriggBot"))()
    end,
})

MainTab:CreateButton({
    Name = "Discord : m1.mz",
    Callback = function() end,
})

MainTab:CreateButton({
    Name = "made by the one and only mizzy",
    Callback = function() end,
})

print("Script loaded successfully")
